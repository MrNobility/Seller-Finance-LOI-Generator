
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LOI Generator v2.2</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 900px; margin: auto; background: #f2f2f2; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input, textarea { width: 100%; padding: 8px; margin-top: 5px; font-size: 14px; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 16px; cursor: pointer; }
    #output { margin-top: 30px; background: #fff; padding: 25px; border: 1px solid #ccc; border-radius: 6px; font-size: 16px; line-height: 1.6; }
    #copyBtn, #generateCashBtn { display: inline-block; background-color: #007BFF; color: white; border: none; margin-right: 10px; }
    #copyMessage { color: green; margin-top: 10px; font-weight: bold; display: none; }
  </style>
</head>
<body>

  <h2>Seller Finance LOI Generator v2.2 (TSV-Aware)</h2>

  <label>Paste Google Sheets Row (TSV Format)</label>
  <textarea id="pastedText" rows="4" placeholder="Paste tab-separated row from Google Sheets..."></textarea>
  <button onclick="extractData()">Auto-Fill Fields</button>

  <label>Agent Name</label>
  <input type="text" id="agentName">

  <label>Property Address</label>
  <input type="text" id="propertyAddress">

  <label>Asking Price ($)</label>
  <input type="number" id="askingPrice">

  <label>Purchase Price ($)</label>
  <input type="number" id="purchasePrice">

  <label>Down Payment ($)</label>
  <input type="number" id="downPayment">

  <label>Monthly Payment (PITI) ($)</label>
  <input type="number" id="monthlyPayment">

  <label>Interest Rate (%)</label>
  <input type="number" id="interestRate" step="0.01">

  <label>Balloon Term (years)</label>
  <input type="number" id="balloonTerm">

  <label>Amortization (years)</label>
  <input type="number" id="amortization" value="30">

  <label>Monthly Insurance ($)</label>
  <input type="number" id="insurance">

  <label>Monthly Property Taxes ($)</label>
  <input type="number" id="taxes">

  <label>Close of Escrow</label>
  <input type="text" id="closeEscrow" placeholder="e.g. On or before 30 days">

  <label>Earnest Money Deposit ($)</label>
  <input type="number" id="emd">

  <script>
    function extractData() {
      const pasted = document.getElementById('pastedText').value;
      const fields = pasted.split(/\t+/);
      if (fields.length < 30) {
        alert("TSV data looks incomplete. Please ensure you're pasting the full row from your Google Sheet.");
        return;
      }

      // Map key fields from the TSV structure
      document.getElementById('propertyAddress').value = fields[1] || '';
      document.getElementById('purchasePrice').value = fields[2] || '';
      document.getElementById('askingPrice').value = fields[3] || '';
      document.getElementById('monthlyPayment').value = fields[5] || '';
      document.getElementById('balloonTerm').value = fields[6] || '';
      document.getElementById('insurance').value = fields[7] || '';
      document.getElementById('taxes').value = fields[8] || '';
      document.getElementById('closeEscrow').value = fields[15] || '';
      document.getElementById('emd').value = fields[16] || '';
    }
  </script>

</body>
</html>
