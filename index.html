<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LOI Generator v2.0</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 900px; margin: auto; background: #f2f2f2; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input, textarea { width: 100%; padding: 8px; margin-top: 5px; font-size: 14px; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 16px; cursor: pointer; }
    #output { margin-top: 30px; background: #fff; padding: 25px; border: 1px solid #ccc; border-radius: 6px; font-size: 16px; line-height: 1.6; }
    #copyBtn, #generateCashBtn { display: inline-block; background-color: #007BFF; color: white; border: none; margin-right: 10px; }
    #copyMessage { color: green; margin-top: 10px; font-weight: bold; display: none; }
  </style>
</head>
<body>

  <h2>Seller Finance LOI Generator v2.0</h2>

  <label>Paste Property Info (optional)</label>
  <textarea id="pastedText" rows="4" placeholder="Paste description here..."></textarea>
  <button onclick="extractData()">Auto-Fill Fields</button>

  <label>Agent Name</label>
  <input type="text" id="agentName">

  <label>Property Address</label>
  <input type="text" id="propertyAddress">

  <label>Asking Price ($)</label>
  <input type="number" id="askingPrice">

  <label>Purchase Price ($)</label>
  <input type="number" id="purchasePrice">

  <label>Down Payment ($)</label>
  <input type="number" id="downPayment">

  <label>Monthly Payment (PITI) ($)</label>
  <input type="number" id="monthlyPayment">

  <label>Interest Rate (%)</label>
  <input type="number" id="interestRate" step="0.01">

  <label>Balloon Term (years)</label>
  <input type="number" id="balloonTerm">

  <label>Amortization (years)</label>
  <input type="number" id="amortization">

  <label>Monthly Insurance ($)</label>
  <input type="number" id="insurance">

  <label>Monthly Property Taxes ($)</label>
  <input type="number" id="taxes">

  <label>Close of Escrow</label>
  <input type="text" id="closeEscrow" placeholder="e.g. On or before 30 days">

  <label>Earnest Money Deposit ($)</label>
  <input type="number" id="emd">

  <label>Your Phone Number</label>
  <input type="text" id="phone" value="512-265-5448">

  <label>Contingencies (optional)</label>
  <textarea id="contingencies" rows="3">- Clear Title
- Property Condition acceptable upon inspection
- Verification of Rental Income</textarea>

  <button onclick="generateEmail()">Generate Seller Finance LOI</button>
  <button id="generateCashBtn" onclick="generateCashLOI()">Generate Cash Offer LOI</button>

  <div id="output"></div>
  <button id="copyBtn" onclick="copyToClipboard()">Copy to Clipboard</button>
  <div id="copyMessage">Copied to clipboard ✅</div>

  <script>
    function formatCurrency(val) {
      if (!val) return "";
      return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(val);
    }

    function formatPercent(purchase, asking) {
      if (!purchase || !asking || asking == 0) return "";
      return ((purchase - asking) / asking * 100).toFixed(1) + '%';
    }

    function getValue(id) {
      return document.getElementById(id).value;
    }

    function extractData() {
      const pasted = getValue('pastedText');
      if (!pasted) return;
      const addressMatch = pasted.match(/\d{3,}[^\n\r]+/);
      const priceMatch = pasted.match(/\$?\d{2,3}[,\d]+/g);
      if (addressMatch) document.getElementById('propertyAddress').value = addressMatch[0].trim();
      if (priceMatch && priceMatch.length > 0) document.getElementById('askingPrice').value = priceMatch[0].replace(/[^\d.]/g, '');
    }

    function generateEmail(isCash = false) {
      const agent = getValue('agentName');
      const address = getValue('propertyAddress');
      const asking = parseFloat(getValue('askingPrice'));
      const price = parseFloat(getValue('purchasePrice'));
      const down = formatCurrency(getValue('downPayment'));
      const monthly = formatCurrency(getValue('monthlyPayment'));
      const rate = getValue('interestRate') ? parseFloat(getValue('interestRate')).toFixed(2) + '%' : '';
      const balloon = getValue('balloonTerm') + ' years';
      const amort = getValue('amortization') + ' years';
      const insurance = formatCurrency(getValue('insurance'));
      const taxes = formatCurrency(getValue('taxes'));
      const escrow = getValue('closeEscrow');
      const emd = formatCurrency(getValue('emd'));
      const phone = getValue('phone');
      const contingencies = getValue('contingencies');
      const percentAbove = formatPercent(price, asking);

      let offerDetails = `
<strong>Offer Details:</strong><br>
<strong>Purchase Price:</strong> ${formatCurrency(price)}<br>
<strong>Down Payment:</strong> ${down}<br>
<strong>Monthly Payment (PITI):</strong> ${monthly}<br>
<strong>Interest Rate:</strong> ${rate}<br>
<strong>Balloon Term:</strong> ${balloon}<br>
<strong>Amortization:</strong> ${amort}<br>
<strong>Monthly Insurance:</strong> ${insurance}<br>
<strong>Monthly Property Taxes:</strong> ${taxes}<br>
<strong>Close of Escrow:</strong> ${escrow}<br>
<strong>EMD:</strong> ${emd}<br>`;

      const contingenciesBlock = `<br><strong>Contingencies:</strong><br>${contingencies.replace(/\n/g, '<br>')}`;

      const output = `
Good Day ${agent},<br><br>
Thank you for taking the time to review our creative offer to purchase your listing at:<br><br>
<strong>${address}</strong><br><br>

We believe this property has tremendous potential. However, as you’re likely aware, today’s high-interest rate environment has made it increasingly difficult for both investors and retail buyers to make the numbers work. Conventional financing rarely produces positive cash flow at this price point, and many retail buyers struggle to qualify for loans on properties like this.<br><br>

That’s why we’re presenting a seller finance structure that delivers:<br>
<strong>ABOVE asking price</strong> ${percentAbove ? '(' + percentAbove + ')' : ''}<br>
<strong>Passive monthly income</strong><br>
<strong>Built-in Safeguards</strong> for peace of mind<br><br>

${offerDetails}
${contingenciesBlock}

<br><br><strong>Buyer Safeguards – For Seller’s Peace of Mind</strong><br>
To reinforce our commitment and offer you full protection, we will execute a <strong>Deed in Lieu of Foreclosure</strong> at closing. If we ever miss two consecutive payments, you can reclaim the property without undergoing a lengthy legal process.<br><br>

<strong>Why This Is a Win-Win</strong><br>
You receive:<br>
- ABOVE asking price ${percentAbove ? '(' + percentAbove + ')' : ''}<br>
- Reliable monthly income stream<br>
- Secure fallback option in the unlikely event of buyer default<br><br>

Meanwhile, we gain the opportunity to invest in and revitalize a great property in a neighborhood we believe in.<br><br>

Please don’t hesitate to reach out if you have any questions or would like to discuss the terms. We’re prepared to move quickly and ensure a smooth, transparent transaction.<br><br>

Warm regards,<br>
Dalton Eddleman<br>
${phone}<br>
Mr.Nobility@nobility.network<br><br>

<em><strong>Disclaimer:</strong><br>
This letter is a non-binding expression of interest and does not constitute a formal or legally binding agreement. All terms are subject to further due diligence, negotiation, and execution of a mutually acceptable purchase agreement.</em>
      `;

      document.getElementById('output').innerHTML = output.trim();
      document.getElementById('copyBtn').style.display = 'inline-block';
      document.getElementById('copyMessage').style.display = 'none';
    }

    function generateCashLOI() {
      generateEmail(true);
    }

    function copyToClipboard() {
      const temp = document.createElement("textarea");
      temp.value = document.getElementById("output").innerText;
      document.body.appendChild(temp);
      temp.select();
      document.execCommand("copy");
      document.body.removeChild(temp);
      document.getElementById("copyMessage").style.display = 'block';
    }
  </script>

</body>
</html>
